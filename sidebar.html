<!DOCTYPE html>
<html>
	<head>
		<base target="_top">
		<style>
			body
			{
				font-family: Arial, sans-serif;
				margin: 20px;
			}
			label
			{
				display: block;
				margin-top: 10px;
			}
			input
			{
				width: 100%;
				padding: 8px;
				margin-top: 5px;
				box-sizing: border-box;
			}
			button
			{
				margin-top: 20px;
				padding: 10px 15px;
				background-color: #4285F4;
				color: white;
				border: none;
				cursor: pointer;
			}
			button:hover
			{
				background-color: #357ae8;
			}
		</style>
	</head>
	<body>
		<h2>Teknocrat</h2>
		<p>Create Google Docs from a template and sheet data.</p>
		
		<label for="template-url">Template Google Doc URL:</label>
		<input type="text" id="template-url">
		
		<label for="data-range">Data Range (e.g., A1:C10):</label>
		<input type="text" id="data-range">

		<label for="output-folder-id">Output Folder ID:</label>
		<input type="text" id="output-folder-id">
		<small>Right-click a folder in Google Drive, select "Get link", and copy the ID from the URL.</small>

		<label for="doc-path">Document Name Template:</label>
		<input type="text" id="doc-path">
		
		<button onclick="generateDocs()">Generate Docs</button>
		
		<script>
			window.addEventListener('load', function() {
				google.script.run.withSuccessHandler(function(props) {
					document.getElementById('template-url').value = props['teknocrat.templateUrl'] || '';
					document.getElementById('data-range').value = props['teknocrat.dataRange'] || '';
					document.getElementById('output-folder-id').value = props['teknocrat.outputFolderId'] || '';
					document.getElementById('doc-path').value = props['teknocrat.docPath'] || '';
				}).getUserProperties();
			});

			function generateDocs()
			{
				const templateUrl = document.getElementById('template-url').value;
				const dataRange = document.getElementById('data-range').value;
				const outputFolderId = document.getElementById('output-folder-id').value;
				const docPath = document.getElementById('doc-path').value;

				// Save the values before running the generation
				google.script.run.saveUserProperties(templateUrl, dataRange, outputFolderId, docPath);

				google.script.run.generateDocuments(templateUrl, dataRange, outputFolderId, docPath);
			}
		</script>
	</body>
</html>